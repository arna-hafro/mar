---
title: "mar"
output: 
  html_document: 
    keep_md: yes
---

## dplyr-erized connection to MRI oracle database

```{r, message = FALSE}
# devtools::install_github("hadley/dplyr")
# devtools::install_github("fishvice/dplyrOracle",  dependencies = FALSE)
# devtools::install_github("fishvice/mar",  dependencies = FALSE)
library(dplyr)
library(dplyrOracle)
library(mar)
ls(2)
mar <- src_oracle("mar")
d <- lods_oslaegt(mar) %>%
  left_join(skipaskra(mar) %>% select(skip_nr, flokkur), by = "skip_nr") %>% 
  filter(fteg == 1,
         flokkur != -4,
         veidisvaedi == "I") %>%
  group_by(timabil, gerd) %>%
  summarise(afli = sum(magn_oslaegt)) %>%
  arrange(timabil, gerd)
explain(d)
d %>% collect()
```

```{r}
devtools::session_info()
```
